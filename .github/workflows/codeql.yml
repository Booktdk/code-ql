secrets:
  name: Secrets Scan (Gitleaks OSS)
  runs-on: ubuntu-latest
  steps:
    - name: Checkout
      uses: actions/checkout@v4

    - name: Gitleaks scan
      uses: gitleaks/gitleaks-action@v2
      with:
        args: detect --report-format sarif --report-path gitleaks.sarif --exit-code 1

    - name: Upload SARIF to code scanning
      uses: github/codeql-action/upload-sarif@v3
      with:
        sarif_file: gitleaks.sarif
